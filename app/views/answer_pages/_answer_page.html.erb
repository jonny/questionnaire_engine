<% page_dom = @presenter.active_page.dom_id
   next_js = load_page_js(@presenter.next_page) -%>

<div id="<%= page_dom %>" class="answer-page" style="<% if show_first.nil? -%>display: none;<% end -%>">  <!-- this id is parsed by qe.public.js -->

  <div class="page">
    <h3 id='page-name'><%= @presenter.active_page.label %></h3>
    
    <% if @elements.length > 0 -%>
      <%= form_tag @presenter.active_page.save_path, :id => "#{page_dom}-form", :onsubmit => next_js + "; return false;", :multipart => true do -%>
        <ul class="questions" id="questions_list">
          <% @elements.each do |element| %>
            <li class="<%= element.class.to_s.downcase %>" id="element_<%= element.id %>">
              <%= render 'answer_pages/element', :element => element %>
            </li>
          <% end %>
        </ul>     
      
        <% if next_js.empty? -%>
          <div id="submit_message" class="validation-advice" style="display: none;"></div>
          <%= button_to_function "Submit", "page_handler.completeAll(); return false", :id => 'submit_button' %>
        <% else -%>
          <%= submit_tag "Next" %>
        <% end -%>
         
      <% end -%>
  
    <% else -%>
        
        <div style="background: #ffc;">
          <p>That's odd. There are no questions on this page yet.</p>
        </div>
    
    <% end -%>
    
  </div>

</div>
